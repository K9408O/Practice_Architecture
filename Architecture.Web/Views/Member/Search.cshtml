@model Architecture.Common.DTO.SearchDto

<h2>單一會員查詢</h2>

<form id="searchForm">
    <div>
        <label>手機：</label>
        <input type="text" id="Phone" name="Phone" maxlength="10" />
    </div>
    <button type="submit" class="btn btn-primary">查詢</button>
</form>

<div id="searchResult" class="mt-3"></div>

@section scripts {
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script>
(function() {
    const apiBase = 'https://localhost:44362'; // 改成你的 API URL

    $('#searchForm').on('submit', function (e) {
        e.preventDefault();
        const phone = $('#Phone').val().trim();

        $.ajax({
            url: `${apiBase}/api/member/search`,
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ phone: phone }),
            success: function (member) {
                console.log("✅ 接收到回傳資料", member);
                if (!member) {
                    $('#searchResult').html('<div>查無此會員</div>').css('color', 'red');
                    return;
                }

                const birthdayText = member.birthday ? member.birthday.split('T')[0] : '無資料';

                $('#searchResult').html(`
                    <div>姓名：${member.Name}</div>
                    <div>手機：${member.Phone}</div>
                    <div>市話：${member.Tel || ''}</div>
                    <div>性別：${member.Gender}</div>
                    <div>生日：${member.Birthday ? member.Birthday.split('T')[0] : '無資料'}</div>
                `).css('color', 'black');
            }
        });
    });
})();
    </script>
}
